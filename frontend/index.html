<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>ea.mxshop</title>
<style>
  *{box-sizing:border-box;}
  body{background:#000;color:#fff;font-family:'Poppins',sans-serif;margin:0;padding:0;}
  h1,h2,h3{text-align:center;letter-spacing:1px;}
  a{color:#fff;text-decoration:none;}
  button{cursor:pointer;}
  header{background:#111;display:flex;justify-content:space-between;align-items:center;padding:15px 40px;position:sticky;top:0;z-index:100;box-shadow:0 2px 10px rgba(255,255,255,0.1);}
  .logo{font-size:1.5em;font-weight:bold;letter-spacing:2px;}
  nav a{margin:0 15px;font-size:1em;transition:color 0.3s;}
  nav a:hover{color:rgb(68,83,83);}
  .carrito-icono{font-size:1.5em;position:relative;}
  .contador{position:absolute;top:-8px;right:-10px;background:red;color:white;border-radius:50%;padding:2px 7px;font-size:0.8em;}
  .contenedor{display:flex;flex-wrap:wrap;justify-content:center;gap:40px;padding:60px 20px;}
  .producto{width:300px;background:#111;border-radius:20px;overflow:hidden;box-shadow:0 0 20px rgba(255,255,255,0.1);transition:transform 0.3s ease,box-shadow 0.3s ease;text-align:center;position:relative;}
  .producto:hover{transform:scale(1.05);box-shadow:0 0 30px rgba(255,255,255,0.2);}
  .carousel{position:relative;width:100%;height:300px;overflow:hidden;}
  .carousel img{width:100%;height:300px;object-fit:cover;position:absolute;top:0;left:0;opacity:0;transition:opacity 1s ease;}
  .carousel img.active{opacity:1;}
  .boton{position:absolute;top:50%;transform:translateY(-50%);background-color:rgba(255,255,255,0.1);border:none;color:white;font-size:24px;cursor:pointer;padding:10px;border-radius:50%;transition:background-color 0.3s;z-index:10;}
  .boton:hover{background-color:rgba(255,255,255,0.4);}
  .prev{left:10px;}
  .next{right:10px;}
  .modelo{margin:15px 0;font-size:1.2em;font-weight:600;text-transform:uppercase;}
  .precio{font-size:1em;color:rgba(255,255,255,0.4);margin-bottom:10px;}
  .agregar{background-color:rgba(255,255,255,0.4);border:none;color:#000;font-weight:bold;padding:10px 20px;margin-bottom:20px;border-radius:8px;transition:0.3s;}
  .agregar:hover{background-color:rgba(255,255,255,0.6);}
  .carrito{position:fixed;top:80px;right:20px;background:#111;padding:20px;border-radius:15px;width:280px;box-shadow:0 0 20px rgba(255,255,255,0.2);display:none;}
  .carrito h3{margin-top:0;}
  .carrito-item{display:flex;justify-content:space-between;margin:10px 0;}
  .carrito-total{border-top:1px solid #333;margin-top:10px;padding-top:10px;font-weight:bold;}
  .btn-pagar{margin-top:10px;background-color:#fff;color:#000;padding:10px 15px;border:none;border-radius:8px;font-weight:bold;cursor:pointer;}
  .btn-pagar:hover{background-color:#444;color:#fff;}
  .contacto{background:#111;padding:60px 20px;text-align:center;}
  .contacto form{max-width:400px;margin:0 auto;display:flex;flex-direction:column;gap:15px;}
  input,textarea{padding:10px;border-radius:8px;border:none;background:#222;color:#fff;}
  button.enviar{background:rgba(255,255,255,0.4);border:none;color:#000;font-weight:bold;padding:12px;border-radius:8px;transition:0.3s;}
  button.enviar:hover{background:rgba(255,255,255,0.6);}
  .pago{background:#000;color:#fff;padding:2rem;border-radius:12px;max-width:500px;margin:2rem auto;display:none;}
  .pago input,.pago textarea{width:100%;padding:10px;margin:8px 0;border-radius:8px;border:none;}
  .pago button{background:#fff;color:#000;border:none;padding:10px 15px;border-radius:8px;cursor:pointer;font-weight:bold;}
  .pago button:hover{background:#444;color:#fff;}
  footer{background-color:#000;padding:20px;font-size:0.9em;color:#777;border-top:1px solid #222;}
  @media(max-width:768px){.producto{width:90%;}}
</style>
</head>
<body>

<header>
  <div class="logo">ea.mxshop</div>
  <nav>
    <a href="#catalogo">CatÃ¡logo</a>
    <a href="#contacto">ContÃ¡ctanos</a>
  </nav>
  <div class="carrito-icono" onclick="toggleCarrito()">ðŸ›’ <span class="contador" id="contador">0</span></div>
</header>

<section id="catalogo">
  <h1>CatÃ¡logo de Productos</h1>
  <div class="contenedor" id="contenedorProductos"></div>
</section>

<div class="carrito" id="carrito">
  <h3>ðŸ›’ Tu carrito</h3>
  <div id="listaCarrito"></div>
  <p class="carrito-total">Total: $<span id="total">0</span></p>
  <button class="btn-pagar" onclick="mostrarFormularioPago()">Pagar carrito</button>
</div>

<section id="pago" class="pago">
  <h2>Finalizar pedido</h2>
  <form id="formPago">
    <input type="text" id="nombrePago" placeholder="Tu nombre completo" required>
    <input type="email" id="correoPago" placeholder="Tu correo" required>
    <input type="tel" id="telefonoPago" placeholder="Tu telÃ©fono" required>
    <textarea id="direccionPago" rows="3" placeholder="Tu direcciÃ³n completa" required></textarea>
    <p><strong>Total a pagar:</strong> $<span id="totalPago">0</span></p>
    <button type="submit" class="enviar">Confirmar pedido</button>
  </form>
  <div id="estadoPedido" style="margin-top:10px;"></div>
</section>

<section id="contacto" class="contacto">
  <h2>ContÃ¡ctanos</h2>
  <form id="formContacto">
    <input type="text" id="nombre" placeholder="Tu nombre" required>
    <input type="email" id="correo" placeholder="Tu correo" required>
    <textarea id="mensaje" rows="4" placeholder="Tu mensaje" required></textarea>
    <button type="submit" class="enviar">Enviar</button>
  </form>
  <div id="estadoMensaje" style="margin-top:10px;"></div>
</section>

<footer>Â© 2025 ea.mxshop â€” Todos los derechos reservados</footer>

<div id="mensajeCarrito" style="position:fixed; top:100px; right:20px; background:green; color:white; padding:10px 20px; border-radius:8px; display:none; z-index:200;"></div>

<script>
let carrito = [];
let productos = [
  {id:1, nombre:'Playera Michael Kors', precio:580, stock:5, imagenes:['imagenes/PlayeraMichaelKors1.jpg','imagenes/PlayeraMichaelKors2.jpg']},
  {id:2, nombre:'Playera Off White', precio:580, stock:3, imagenes:['imagenes/PlayeraOffWhite1.jpg','imagenes/PlayeraOffWhite2.jpg','imagenes/PlayeraOffWhite3.jpg','imagenes/PlayeraOffWhite4.jpg']},
  {id:3, nombre:'Playera Hellstar', precio:580, stock:8, imagenes:['imagenes/PlayeraHellstar1.jpg','imagenes/PlayeraHellstar2.jpg','imagenes/PlayeraHellstar3.jpg','imagenes/PlayeraHellstar4.jpg']},
  {id:4, nombre:'Playera Hellstar Azul', precio:580, stock:1, imagenes:['imagenes/PlayeraHellstarAzul1.jpg','imagenes/PlayeraHellstarAzul2.jpg','imagenes/PlayeraHellstarAzul3.jpg','imagenes/PlayeraHellstarAzul4.jpg']},
  {id:5, nombre:'Playera Hugo Azul', precio:580, stock:10, imagenes:['imagenes/PlayeraHugoAzul1.jpg','imagenes/PlayeraHugoAzul2.jpg','imagenes/PlayeraHugoAzul3.jpg']},
  {id:6, nombre:'Playera Boss', precio:580, stock:4, imagenes:['imagenes/PlayeraBoss1.jpg','imagenes/PlayeraBoss2.jpg']},
  {id:7, nombre:'Playera Boss Porche', precio:580, stock:2, imagenes:['imagenes/PlayeraBossPorche1.jpg','imagenes/PlayeraBossPorche2.jpg','imagenes/PlayeraBossPorche3.jpg','imagenes/PlayeraBossPorche4.jpg']},
];

function crearProductos() {
  const contenedor = document.getElementById('contenedorProductos');
  contenedor.innerHTML = "";

  productos.forEach(p => {
    const div = document.createElement('div');
    div.className='producto';

    // Carrusel
    const carrusel = document.createElement('div');
    carrusel.className='carousel';
    p.imagenes.forEach((src,i)=>{
      const img=document.createElement('img');
      img.src=src;
      if(i===0) img.classList.add('active');
      carrusel.appendChild(img);
    });

    const prevBtn=document.createElement('button'); prevBtn.className='boton prev'; prevBtn.textContent='â€¹';
    const nextBtn=document.createElement('button'); nextBtn.className='boton next'; nextBtn.textContent='â€º';
    carrusel.append(prevBtn,nextBtn);

    let index=0;
    const imgs=carrusel.querySelectorAll('img');
    prevBtn.onclick=()=>{ imgs[index].classList.remove('active'); index=(index-1+imgs.length)%imgs.length; imgs[index].classList.add('active'); };
    nextBtn.onclick=()=>{ imgs[index].classList.remove('active'); index=(index+1)%imgs.length; imgs[index].classList.add('active'); };
    setInterval(()=>nextBtn.click(),4000);

    const nombre=document.createElement('p'); nombre.className='modelo'; nombre.textContent=p.nombre;
    const precio=document.createElement('p'); precio.className='precio'; precio.textContent=`$${p.precio} MXN`;

    const btn=document.createElement('button'); 
    btn.className='agregar'; 
    btn.textContent = p.stock > 0 ? 'Agregar al carrito' : 'AGOTADO';

    // Si el producto estÃ¡ agotado, mostrar mensaje al hacer clic
    btn.onclick = () => {
      if(p.stock > 0){
        agregarCarrito(p);
      } else {
        alert("Este producto no se encuentra disponible");
      }
    }

    if(p.stock === 0) btn.disabled=false; // permitimos el clic para mostrar alerta

    div.append(carrusel,nombre,precio,btn);
    contenedor.appendChild(div);
  });
}


function agregarCarrito(p){
  if(p.stock>0){
    carrito.push({id:p.id,nombre:p.nombre,precio:p.precio});
    p.stock--;
    // Actualizar botÃ³n si se agota
    const productosDivs = document.querySelectorAll('.producto');
    productosDivs.forEach(d=>{
      if(d.querySelector('.modelo').textContent === p.nombre){
        const btn = d.querySelector('button');
        if(p.stock===0){ 
          btn.textContent='AGOTADO';
          btn.disabled=true;
        }
      }
    });
    actualizarCarritoUI();

      // Mostrar mensaje de producto agregado
    const mensaje = document.getElementById('mensajeCarrito');
    mensaje.textContent = ` ${p.nombre} agregado al carrito`;
    mensaje.style.display = 'block';
    setTimeout(()=>{ mensaje.style.display = 'none'; }, 2000); // desaparece en 2s
  }
}

function actualizarCarritoUI(){
  const lista=document.getElementById('listaCarrito');
  lista.innerHTML='';
  let total=0;
  carrito.forEach((item,idx)=>{
    total+=item.precio;
    const div=document.createElement('div'); div.className='carrito-item';
    div.innerHTML=`${item.nombre} $${item.precio} <button onclick="eliminarDelCarrito(${idx})" style="background:none;border:none;color:red;">âœ–</button>`;
    lista.appendChild(div);
  });
  document.getElementById('total').textContent=total;
  document.getElementById('totalPago').textContent=total;
  document.getElementById('contador').textContent=carrito.length;
}

function eliminarDelCarrito(i){
  carrito.splice(i,1);
  actualizarCarritoUI();
}

function toggleCarrito(){
  const c=document.getElementById('carrito');
  c.style.display=c.style.display==='block'?'none':'block';
}

function mostrarFormularioPago(){
  if(carrito.length===0){ alert('Tu carrito estÃ¡ vacÃ­o'); return; }
  document.getElementById('pago').style.display='block';
  window.scrollTo(0,document.getElementById('pago').offsetTop);
}

// --- Enviar pedido ---
document.getElementById('formPago').addEventListener('submit', async e=>{
  e.preventDefault();
  if(carrito.length===0) return alert("Carrito vacÃ­o");

  const nombre = document.getElementById('nombrePago').value;
  const correo = document.getElementById('correoPago').value;
  const telefono = document.getElementById('telefonoPago').value;
  const direccion = document.getElementById('direccionPago').value;
  const total = carrito.reduce((a,b)=>a+b.precio,0);
  const numeroOrden = "ORD"+Date.now(); // NÃºmero de orden

  try {
    const res = await fetch('http://ea-mxshop.orender.com/pedidos',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify({nombre,correo,telefono,direccion,total,items:carrito,numeroOrden})
    });
    const data = await res.json();
    if(data.ok){
      document.getElementById('estadoPedido').innerHTML=` Pedido registrado. Tu nÃºmero de orden es <strong>${numeroOrden}</strong>`;
      carrito=[];
      actualizarCarritoUI();
    } else {
      document.getElementById('estadoPedido').textContent='Error: '+data.error;
    }
  } catch(err){
    document.getElementById('estadoPedido').textContent='Error de conexiÃ³n';
    console.error(err);
  }
});

// --- Enviar contacto ---
document.getElementById('formContacto').addEventListener('submit', async e=>{
  e.preventDefault();
  const nombre=document.getElementById('nombre').value;
  const correo=document.getElementById('correo').value;
  const mensaje=document.getElementById('mensaje').value;

  try {
    const res = await fetch('http://ea-mxshop.orender.com/contacto',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify({nombre,correo,mensaje})
    });
    const data = await res.json();
    if(data.ok) document.getElementById('estadoMensaje').textContent='Mensaje enviado correctamente';
    else document.getElementById('estadoMensaje').textContent='Error: '+data.error;
  } catch(err){
    document.getElementById('estadoMensaje').textContent='Error de conexiÃ³n';
    console.error(err);
  }
});

document.addEventListener('DOMContentLoaded',()=>{
  crearProductos();
  actualizarCarritoUI();
});
</script>
</body>
